<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🏋️ Daily Exercise Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { text-align: center; }
    .card {
      border: 1px solid #ddd;
      padding: 10px;
      margin: 8px 0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .notesBox { 
      display: none; 
      margin-top: 8px;
    }
    .buttons { display: flex; gap: 8px; }
    button { padding: 6px 10px; border-radius: 6px; border: none; cursor: pointer; }
    .done { background: lightgreen; }
    .deleteBtn { background: #f88; }
    .toggleBtn { background: #ddd; }
  </style>
</head>
<body>
  <h2>🏋️ Daily Exercise Tracker</h2>

  <div id="exerciseList"></div>

  <div style="margin-top:15px;">
    <input id="newExercise" placeholder="Add new exercise" />
    <button onclick="addExercise()">Add</button>
  </div>

  <div style="margin-top:15px;">
    <button onclick="backup()">💾 Backup</button>
    <button onclick="restore()">📂 Restore</button>
    <button onclick="clearAll()">🗑 Clear</button>
  </div>

  <script>
    const today = new Date().toISOString().split('T')[0];
    if (!localStorage.getItem(today)) {
      localStorage.setItem(today, JSON.stringify([
        { name: "Running", done: false, notes: "" },
        { name: "Push-ups", done: false, notes: "" },
        { name: "Squats", done: false, notes: "" },
        { name: "Plank", done: false, notes: "" },
        { name: "Yoga", done: false, notes: "" }
      ]));
    }

    function getDayData() {
      return JSON.parse(localStorage.getItem(today));
    }

    function saveData(data) {
      localStorage.setItem(today, JSON.stringify(data));
    }

    function renderExercises() {
      const container = document.getElementById("exerciseList");
      container.innerHTML = "";
      getDayData().forEach((ex, index) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <span>${ex.name}</span>
          <div class="buttons">
            <button onclick="toggleDone(${index})" class="${ex.done ? 'done' : ''}">Mark</button>
            <button class="toggleBtn" onclick="toggleNotes(this, ${index})">v</button>
            <button class="deleteBtn" onclick="deleteExercise(${index})">🗑</button>
          </div>
          <div class="notesBox">
            <input type="text" value="${ex.notes}" 
              oninput="updateNotes(${index}, this.value)" 
              placeholder="Notes (e.g. 20 reps)">
          </div>
        `;
        container.appendChild(card);
      });
    }

    function toggleDone(index) {
      const data = getDayData();
      data[index].done = !data[index].done;
      saveData(data);
      renderExercises();
    }

    function updateNotes(index, value) {
      const data = getDayData();
      data[index].notes = value;
      saveData(data);
    }

    function toggleNotes(btn, index) {
      const box = btn.closest(".card").querySelector(".notesBox");
      if (box.style.display === "none" || box.style.display === "") {
        box.style.display = "block";
        btn.textContent = "^";
      } else {
        box.style.display = "none";
        btn.textContent = "v";
      }
    }

    function addExercise() {
      const name = document.getElementById("newExercise").value.trim();
      if (name) {
        const data = getDayData();
        data.push({ name, done: false, notes: "" });
        saveData(data);
        document.getElementById("newExercise").value = "";
        renderExercises();
      }
    }

    function deleteExercise(index) {
      const data = getDayData();
      data.splice(index, 1);
      saveData(data);
      renderExercises();
    }

    function backup() {
      const blob = new Blob([localStorage.getItem(today)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "backup.json";
      a.click();
    }

    function restore() {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = "application/json";
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = () => {
          localStorage.setItem(today, reader.result);
          renderExercises();
        };
        reader.readAsText(file);
      };
      input.click();
    }

    function clearAll() {
      if (confirm("Clear all exercises for today?")) {
        localStorage.removeItem(today);
        location.reload();
      }
    }

    renderExercises();
  </script>
</body>
</html>
